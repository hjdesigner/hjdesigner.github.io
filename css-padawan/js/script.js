function captureValue(e){13==e.keyCode&&send()}function switchRecognition(){recognition?stopRecognition():startRecognition()}function startRecognition(){(recognition=new webkitSpeechRecognition).continuous=!1,recognition.interimResults=!1,recognition.onstart=function(e){respond(messageRecording),updateRec()},recognition.onresult=function(e){recognition.onend=null;let n="";for(let o=e.resultIndex;o<e.results.length;++o)n+=e.results[o][0].transcript;setInput(n),stopRecognition()},recognition.onend=function(){respond(messageCouldntHear),stopRecognition()},recognition.lang="pt-BR",recognition.start()}function stopRecognition(){recognition&&(recognition.stop(),recognition=null),updateRec()}function setInput(e){document.querySelector("#speech").value=e,send()}function updateRec(){document.querySelector("#rec").innerHTML=recognition?"Stop":"<i class='large material-icons'>settings_voice</i>"}function send(){var e=document.querySelector("#speech").value;let n=new XMLHttpRequest;n.open("POST",`${baseUrl}query`),n.setRequestHeader("Content-Type","application/json;charset=UTF-8"),n.setRequestHeader("Authorization",`Bearer ${accessToken}`),n.onreadystatechange=(()=>{3===n.readyState&&(document.querySelector("#carregando").style.display="block");4===n.readyState&&(200===n.status?(document.querySelector("#carregando").style.display="none",prepareResponse(JSON.parse(n.responseText))):(document.querySelector("#carregando").style.display="none",respond(messageInternalError)))}),n.send(JSON.stringify({query:e,lang:"pt",sessionId:"css-help"}))}function prepareResponse(e){JSON.stringify(e,void 0,2);respond(e.result.speech)}function respond(e){if(""==e&&(e=messageSorry),e!==messageRecording){let n=new SpeechSynthesisUtterance;n.voiceURI="native",n.text=e,n.lang="pt-BR",window.speechSynthesis.speak(n)}document.querySelector("#spokenResponse").classList.add("is-active"),document.querySelector(".spoken-response__text").innerHTML=e}const accessToken="4d9a743be6c444498e88b4b327567e82",baseUrl="https://api.api.ai/v1/",messageRecording="Gravando...",messageCouldntHear="Eu não conseguir te ouvir, pode falar novamente?",messageInternalError="Oh não, houve um erro de servidor interno",messageSorry="Desculpe, ainda não tenho a resposta para isso.";let speechInput,recBtn,recognition;